## test_creds.ps1
# Simple powershell script that will test local (machine) credentials (that you may have harvested) and return True or False
# Example: c:\> powershell.exe -exec bypass -Command .\test_creds.ps1

$LocalUser = "****"
$LocalPass = "****"

    Function Test-LocalAuth {
        param($Username, $Password)
        Add-Type -AssemblyName System.DirectoryServices.AccountManagement
        $Obj = New-Object System.DirectoryServices.AccountManagement.PrincipalContext('machine', $env:COMPUTERNAME)
        $Compliance = $Obj.ValidateCredentials($Username, $Password)
        $Compliance
    }

Test-LocalAuth -Username $LocalUser -Password $LocalPass
