#!/usr/bin/bash

domain=$1
while read sub; do
	cname=$(host -t CNAME $sub.$domain | grep 'an alias' | awk '{print $NF}')
	
	if [ -z "$cname" ]; then
		continue	
	fi
	
	echo -e $cname > cname.txt	
	for line in $(cat cname.txt); do
		echo "debug, line=$line"
		if ! host $line &> /dev/null; then
			echo "$line did not resolve ($sub.$domain)";
		fi
	done
done
